1
00:00:00,000 --> 00:00:07,880
В этом уроке вы узнаете одну из основных концепций в Linux и вообще в операционных

2
00:00:07,880 --> 00:00:12,560
системах - это пользователи операционной системы и их права.

3
00:00:12,560 --> 00:00:18,880
Мы рассмотрим команды Linux для создания пользователей и групп, а также разберёмся, как права

4
00:00:18,880 --> 00:00:25,560
работают и как выдавать пользователям и группам в Linux разные разрешения на работу с файлами и

5
00:00:25,560 --> 00:00:32,000
выполнение действий в системе.

6
00:00:32,000 --> 00:00:38,280
Прежде всего, в системе Linux есть три категории пользователей.

7
00:00:38,280 --> 00:00:40,580
Первая — пользователь root.

8
00:00:40,580 --> 00:00:48,960
Это особый тип пользователя, который имеет неограниченный доступ и права ко всей системе.

9
00:00:48,960 --> 00:00:52,760
Его также называют суперпользователем, потому что он может делать всё.

10
00:00:52,760 --> 00:00:59,320
Если вы хотите выполнить какие-то административные задачи или получить доступ к ограниченным файлам, например,

11
00:00:59,320 --> 00:01:06,120
в вашей системе, вам нужно войти как пользователь root или выполнить команды от имени

12
00:01:06,120 --> 00:01:07,120
пользователя root.

13
00:01:07,120 --> 00:01:11,600
Вторая категория — обычные или стандартные пользователи.

14
00:01:11,600 --> 00:01:17,240
Это пользователи, которых мы создаём для входа в систему.

15
00:01:17,240 --> 00:01:24,040
Так что если я хочу пользоваться компьютером или сервером, у меня будет стандартный пользователь, с которым я смогу

16
00:01:24,040 --> 00:01:28,280
войти в систему и затем делать там свои задачи.

17
00:01:28,280 --> 00:01:34,640
И у каждого обычного или стандартного пользователя будет собственное пространство, которое мы уже видели

18
00:01:34,640 --> 00:01:40,720
в каталоге /home, в папке с тем же именем, что и этот пользователь.

19
00:01:40,720 --> 00:01:44,160
И третий тип — сервисный пользователь.

20
00:01:44,160 --> 00:01:51,400
Сервисный пользователь актуален на серверных дистрибутивах Linux, потому что Linux широко используется

21
00:01:51,400 --> 00:01:59,480
для серверов, а серверы запускают разные сервисы, например сервер баз данных или веб-приложение

22
00:01:59,480 --> 00:02:01,200
сервер и т. д.

23
00:02:01,200 --> 00:02:03,720
И он может запускать несколько таких сервисов.

24
00:02:03,720 --> 00:02:10,200
Так что на сервере может работать приложение Apache, а также база данных MySQL,

25
00:02:10,200 --> 00:02:11,600
и т. д.

26
00:02:11,600 --> 00:02:17,080
И каждый такой сервис или приложение получит своего собственного пользователя.

27
00:02:17,080 --> 00:02:22,760
Так что запускаться они будут не стандартным пользователем и не пользователем root, а

28
00:02:22,760 --> 00:02:29,200
специальным, например пользователем MySQL или Apache, который запустит приложение.

29
00:02:29,200 --> 00:02:30,200
Почему?

30
00:02:30,200 --> 00:02:35,440
Потому что это гарантирует, что каждое приложение изолировано по правам доступа друг

31
00:02:35,440 --> 00:02:39,400
от друга и обеспечивает лучшую безопасность.

32
00:02:39,400 --> 00:02:46,480
И это лучшая практика в управлении серверами и DevOps — запускать сервисы со своими

33
00:02:46,480 --> 00:02:53,440
собственными пользователями; запуск сервиса от root — это очень плохо, потому что это

34
00:02:53,440 --> 00:02:56,200
создаст массу проблем безопасности.

35
00:02:56,200 --> 00:03:02,760
Так что никакой сервис не должен запускаться от пользователя root, потому что тогда сервис фактически получит

36
00:03:02,760 --> 00:03:04,920
права пользователя root.

37
00:03:04,920 --> 00:03:10,560
И он может случайно нарушить работу системы, а если кто-то взломает нашу систему и

38
00:03:10,560 --> 00:03:17,160
конкретно это приложение, он сможет нанести больший ущерб всей системе

39
00:03:17,160 --> 00:03:19,280
с правами пользователя root.

40
00:03:19,280 --> 00:03:23,760
Итак, это три типа пользователей, которые будут в системе.

41
00:03:23,760 --> 00:03:29,080
И на одной машине у вас может быть несколько таких пользователей.

42
00:03:29,080 --> 00:03:35,600
Разумеется, на каждом компьютере или сервере есть один пользователь root, но может быть несколько

43
00:03:35,600 --> 00:03:39,400
дополнительных обычных пользователей и несколько сервисных.

44
00:03:39,400 --> 00:03:45,240
Теперь зачем нам нужно несколько стандартных учетных записей на одной машине, например?

45
00:03:45,240 --> 00:03:52,160
Допустим, у нас есть личный ноутбук или компьютер, который мы используем на работе или в университете.

46
00:03:52,160 --> 00:03:54,360
Зачем нужны несколько учётных записей?

47
00:03:54,360 --> 00:03:58,840
Основная причина — возможность поделиться своим компьютером.

48
00:03:58,840 --> 00:04:06,640
Например, многие компании используют операционную систему Windows для персональных компьютеров или ноутбуков, которые

49
00:04:06,640 --> 00:04:08,680
используют сотрудники.

50
00:04:08,680 --> 00:04:15,640
И к каждому персональному компьютеру или ноутбуку на самом деле может получить доступ любой из сотрудников.

51
00:04:15,640 --> 00:04:19,760
Итак, если вы смените оборудование, смените ноутбук в компании, вы всё равно

52
00:04:19,760 --> 00:04:22,360
сможете получить доступ к этому ноутбуку.

53
00:04:22,360 --> 00:04:25,720
Вы сможете войти под своим пользователем.

54
00:04:25,720 --> 00:04:27,120
То же самое в университетах.

55
00:04:27,120 --> 00:04:32,640
И в университетах есть компьютерные классы, к которым можно получить доступ, и каждый компьютер

56
00:04:32,640 --> 00:04:39,200
доступен любому студенту университета со своими личными учётными данными.

57
00:04:39,200 --> 00:04:41,120
Как же это работает?

58
00:04:41,120 --> 00:04:44,400
У каждого компьютера есть копия всех учётных записей?

59
00:04:44,400 --> 00:04:51,120
Ну, в Windows, и это как раз отличие между Windows и Linux, Windows

60
00:04:51,120 --> 00:04:55,800
есть возможность централизованно управлять пользователями.

61
00:04:55,800 --> 00:05:03,440
Поэтому администраторы в Workspace или университете обычно настраивают

62
00:05:03,440 --> 00:05:09,360
систему со списком всех студентов или всех сотрудников с их учётными записями

63
00:05:09,360 --> 00:05:14,960
для каждого, и затем все компьютеры подключаются к этой системе.

64
00:05:14,960 --> 00:05:22,440
Так что когда кто-то пытается войти в компьютер на работе, например, операционная система

65
00:05:22,440 --> 00:05:29,200
спрашивает у централизованной системы: эй, есть такой пользователь, который пытается войти,

66
00:05:29,200 --> 00:05:34,960
пожалуйста, проверьте учётные данные и дайте доступ, если они верны, или если у вас

67
00:05:34,960 --> 00:05:36,880
есть такой пользователь.

68
00:05:36,880 --> 00:05:41,720
Поэтому когда вы входите на такой компьютер, вы увидите свою домашнюю папку, и всё.

69
00:05:41,720 --> 00:05:47,520
У вас нет доступа к ограниченным или системным папкам, и у вас не будет доступа

70
00:05:47,520 --> 00:05:52,000
к папкам других пользователей, так что всё хорошо изолировано.

71
00:05:52,000 --> 00:05:57,520
И в зависимости от прав, если права строгие, вы можете не иметь возможности менять

72
00:05:57,520 --> 00:05:59,720
что-либо за пределами вашей домашней директории.

73
00:05:59,720 --> 00:06:05,560
Например, вы не сможете просто установить ПО на свой компьютер, потому что

74
00:06:05,560 --> 00:06:10,440
как мы видели, эти установочные файлы оказываются вне вашей домашней директории.

75
00:06:10,440 --> 00:06:17,400
Так что в системах Windows централизованно управляемые права пользователей позволяют вам как сотруднику,

76
00:06:17,400 --> 00:06:22,480
например, входить на любое оборудование, любой компьютер, подключённый к системе на

77
00:06:22,480 --> 00:06:27,080
работе, и фактически видеть свою домашнюю директорию со всеми файлами и всем, что у вас

78
00:06:27,080 --> 00:06:32,040
там есть, и продолжать работать оттуда, так что вы не привязаны к железу.

79
00:06:32,040 --> 00:06:37,960
Но, как я сказал, это специфично для Windows, а у Linux такой возможности нет.

80
00:06:37,960 --> 00:06:44,080
Это одна из причин, почему во многих компаниях или университетах Windows используется как операционная

81
00:06:44,080 --> 00:06:45,080
система.

82
00:06:45,080 --> 00:06:51,520
Однако на Linux-машинах всё ещё есть возможность регистрировать нескольких пользователей.

83
00:06:51,520 --> 00:06:57,360
Однако эти пользователи будут управляться на этом конкретном оборудовании, на этом конкретном компьютере.

84
00:06:57,360 --> 00:07:02,200
Если вы входите на другой компьютер, там будут пользователи, зарегистрированные на

85
00:07:02,200 --> 00:07:03,480
этом конкретном компьютере.

86
00:07:03,480 --> 00:07:06,120
Так что на каждом компьютере это по-разному.

87
00:07:06,120 --> 00:07:12,640
И снова, это вариант использования, если вы хотите разделять один компьютер с многими пользователями,

88
00:07:12,640 --> 00:07:13,640
например.

89
00:07:14,280 --> 00:07:25,160
В Linux, однако, множественные учётные записи более актуальны, когда мы говорим о

90
00:07:25,160 --> 00:07:33,760
серверах, потому что обычно серверами управляют команды администраторов или инженеров.

91
00:07:33,760 --> 00:07:37,680
Поэтому нескольким людям нужен доступ к одним и тем же серверам.

92
00:07:37,720 --> 00:07:45,040
Теперь вы можете спросить, почему все члены команды не могут просто иметь одну учётную запись или одного пользователя,

93
00:07:45,040 --> 00:07:49,160
и затем просто заходить на сервер с этим пользователем?

94
00:07:49,160 --> 00:07:53,840
То есть иметь общего пользователя, по сути, вместо своих личных файлов.

95
00:07:53,840 --> 00:07:58,960
Ведь это сервер, так что они всё равно будут управлять там какими-то сервисами.

96
00:07:58,960 --> 00:08:05,200
Ну, давайте приведём пример, почему дать каждому члену команды своего пользователя действительно важно.

97
00:08:05,200 --> 00:08:10,760
Скажем, у нас в компании есть два сервера, за которыми следит команда системных администраторов

98
00:08:10,760 --> 00:08:12,320
из трёх человек.

99
00:08:12,320 --> 00:08:16,160
Прежде всего, вы не хотите дать им всем пароль root, верно?

100
00:08:16,160 --> 00:08:18,960
Значит, им нужен не root-пользователь.

101
00:08:18,960 --> 00:08:25,520
Потому что снова: root-пользователь должен использоваться только самой системой, и когда вам нужно получить доступ

102
00:08:25,520 --> 00:08:30,480
к ограниченному файлу или сделать что-то, требующее привилегий суперпользователя.

103
00:08:30,480 --> 00:08:34,280
Но помимо этого вам всегда стоит работать под обычным, не-root пользователем.

104
00:08:34,400 --> 00:08:38,840
Также вы можете решать для каждого члена команды, какие права он получает.

105
00:08:38,840 --> 00:08:44,240
Потому что один может быть старшим администратором, другой — младшим.

106
00:08:44,240 --> 00:08:50,960
Так что они могут получать меньше привилегий и меньше прав изменять что-то в системе

107
00:08:50,960 --> 00:08:54,040
или доступ к определенным местам.

108
00:08:54,040 --> 00:09:01,400
Также, когда на сервере работают несколько человек, вы хотите отслеживать, кто что делал в системе.

109
00:09:01,400 --> 00:09:05,320
То есть вам нужна трассируемость в системе.

110
00:09:05,320 --> 00:09:10,840
Потому что если это важный сервер, например, продакшен, и вы хотите знать, что произошло

111
00:09:10,840 --> 00:09:19,000
каким пользователем в конкретное время, не чтобы обвинить, а чтобы понять, кто может помочь решить проблему.

112
00:09:19,000 --> 00:09:24,240
Таковы причины, почему вы хотите дать каждому члену команды его собственную учетную запись

113
00:09:24,240 --> 00:09:25,680
для работы на серверах.

114
00:09:25,680 --> 00:09:31,120
Поэтому, когда вы получаете новый чистый сервер, админ обычно создает этих пользователей.

115
00:09:31,120 --> 00:09:34,920
Чтобы у членов команды был к нему доступ.

116
00:09:34,920 --> 00:09:42,160
А в следующем разделе мы посмотрим, как на деле работает создание пользователей и выдача им прав.

117
00:09:47,320 --> 00:09:52,440
Теперь как мы управляем правами пользователей на системах Linux?

118
00:09:52,440 --> 00:09:55,600
Мы можем управлять правами на двух разных уровнях.

119
00:09:55,600 --> 00:10:01,000
Первый — мы можем давать права непосредственно пользователям.

120
00:10:01,000 --> 00:10:08,680
Например, можно сказать, что новый пользователь, Нана, будет иметь право устанавливать приложения в системе.

121
00:10:08,680 --> 00:10:14,560
У нее будет право выполнять команды с привилегиями суперпользователя и т.д.

122
00:10:14,560 --> 00:10:17,520
То есть мы можем делать это для каждого пользователя.

123
00:10:17,520 --> 00:10:25,120
Другой способ управления правами — группировать пользователей в группы Linux

124
00:10:25,120 --> 00:10:29,280
и затем давать этой группе определенные права.

125
00:10:29,280 --> 00:10:35,120
И это на самом деле лучший способ, особенно если вы управляете несколькими пользователями,

126
00:10:35,120 --> 00:10:38,760
определяя группу в системе Linux.

127
00:10:38,760 --> 00:10:46,280
Например, если у вас есть команда DevOps, то у вас будет группа DevOps или может быть группа администраторов.

128
00:10:46,280 --> 00:10:48,760
У вас также может быть группа для разработчиков.

129
00:10:48,760 --> 00:10:57,440
Затем вы добавляете всех этих пользователей в группу, и у вас будут права, определенные для этой группы

130
00:10:57,480 --> 00:10:59,480
а не напрямую для пользователя.

131
00:10:59,480 --> 00:11:06,880
И это суперудобно и намного проще управлять, если у вас десятки или сотни пользователей.

132
00:11:06,880 --> 00:11:12,680
Если у вас 50 пользователей, вы не хотите настраивать права для каждого из них по одному.

133
00:11:12,680 --> 00:11:18,520
А когда они больше не в команде, затем забирать у них права и так далее.

134
00:11:18,520 --> 00:11:21,960
Гораздо проще просто добавить пользователя в группу.

135
00:11:21,960 --> 00:11:27,280
Так он получит все права, которые есть у группы, а затем удалить пользователя из группы

136
00:11:27,280 --> 00:11:30,640
и он потеряет все права, полученные от группы.

137
00:11:30,640 --> 00:11:36,520
Поэтому обычно, работая с пользователями, мы также работаем с группами.

138
00:11:36,520 --> 00:11:43,720
Каждый пользователь по умолчанию будет частью одной группы, и вы даже можете добавить пользователя в несколько групп.

139
00:11:43,720 --> 00:11:48,560
Тогда они получат все права от всех групп, частью которых они являются.

140
00:11:48,560 --> 00:11:53,240
И это очень важная концепция в системах Linux.

141
00:11:53,240 --> 00:12:02,120
Теперь, когда мы знаем все это теоретически, давайте посмотрим, как на практике работает управление пользователями и группами в Linux.

142
00:12:06,600 --> 00:12:14,240
Вернувшись в нашу систему Ubuntu, мы посмотрим, как создавать новых пользователей и давать им права.

143
00:12:14,240 --> 00:12:22,800
Сначала давайте посмотрим, где хранится список всех пользователей системы и как получить к нему доступ.

144
00:12:22,800 --> 00:12:28,520
Эта информация хранится в файле /etc/passwd.

145
00:12:28,520 --> 00:12:34,320
И поскольку это файл, мы можем просто вывести его содержимое.

146
00:12:34,320 --> 00:12:41,160
Напомню, /etc — это место конфигурации системы.

147
00:12:41,200 --> 00:12:45,000
И там находятся пользователи, зарегистрированные в системе.

148
00:12:45,000 --> 00:12:51,680
Так что если я выведу содержимое, вы увидите этот не очень дружелюбный для пользователя список.

149
00:12:51,680 --> 00:12:54,280
Однако он не очень сложный.

150
00:12:54,280 --> 00:13:04,240
На самом деле каждая строка здесь представляет пользователя, например, вот эта, это мой пользователь, которого я создала.

151
00:13:04,240 --> 00:13:07,800
Давайте посмотрим, что на самом деле означает вся эта информация.

152
00:13:07,840 --> 00:13:11,760
Во‑первых, у нас есть имя пользователя, затем стоит X.

153
00:13:11,760 --> 00:13:14,400
И вы видите, что X стоит для всех остальных пользователей.

154
00:13:14,400 --> 00:13:18,200
И это на самом деле заполнитель для пароля пользователя.

155
00:13:18,200 --> 00:13:23,800
Очевидно, он не выводится здесь открытым текстом, потому что это пароль, чувствительные данные.

156
00:13:23,800 --> 00:13:26,640
Поэтому мы просто видим заполнитель X.

157
00:13:26,640 --> 00:13:31,600
Сам пароль на самом деле хранится в другом файле для безопасности.

158
00:13:31,600 --> 00:13:37,640
Далее здесь число, которое представляет уникальный ID пользователя.

159
00:13:37,640 --> 00:13:46,160
Например, у моего пользователя Nana ID 1000, а у пользователя root в системе всегда ID ноль.

160
00:13:46,160 --> 00:13:52,200
Второе число, которое мы видим, — это ID основной группы этого пользователя.

161
00:13:52,200 --> 00:13:56,880
У групп тоже есть свои ID, и у каждого пользователя есть основная группа,

162
00:13:56,880 --> 00:14:03,800
к которой он принадлежит, и ID основной группы тоже хранится здесь.

163
00:14:03,800 --> 00:14:08,080
Далее идет описание пользователя, полное имя и т.д.

164
00:14:08,080 --> 00:14:16,120
Это домашний каталог пользователя, а это оболочка по умолчанию,

165
00:14:16,120 --> 00:14:25,280
slash bin slash pesh, фактически оболочка, которую мы используем здесь для выполнения разных команд.

166
00:14:25,280 --> 00:14:27,400
И, как я сказала, это файл.

167
00:14:27,400 --> 00:14:29,840
Так как же добавить нового пользователя?

168
00:14:29,840 --> 00:14:31,480
Это на самом деле довольно просто.

169
00:14:31,480 --> 00:14:37,160
Мы уже видели команду add user и имя пользователя.

170
00:14:37,160 --> 00:14:39,000
И давайте назовем его Tom.

171
00:14:39,000 --> 00:14:44,760
Однако добавление пользователя в системе — административная задача.

172
00:14:44,760 --> 00:14:50,200
Поэтому здесь нам нужны привилегии суперпользователя.

173
00:14:50,200 --> 00:14:57,280
И если я выполню и введу свой пароль, это создаст нового пользователя.

174
00:14:57,280 --> 00:15:03,400
И нам нужно задать начальный пароль для пользователя

175
00:15:03,400 --> 00:15:15,120
а также полное имя, номер комнаты и так далее.

176
00:15:15,120 --> 00:15:16,520
И подтвердить.

177
00:15:16,520 --> 00:15:25,200
И снова, если теперь вывести список пользователей, мы увидим здесь Tom.

178
00:15:25,200 --> 00:15:30,880
И вся информация, которую мы ввели, перечислена здесь через запятую.

179
00:15:30,880 --> 00:15:33,920
И у Tom тоже появился свой ID пользователя.

180
00:15:33,920 --> 00:15:37,800
А это ID основной группы пользователя.

181
00:15:37,800 --> 00:15:41,200
Теперь, откуда вообще берется эта основная группа?

182
00:15:41,200 --> 00:15:47,160
Каждый раз, когда мы создаем пользователя с помощью user add по умолчанию,

183
00:15:47,160 --> 00:15:55,000
также создается группа с тем же именем, что и у пользователя, и она устанавливается как ID основной группы

184
00:15:55,040 --> 00:15:55,920
пользователя.

185
00:15:55,920 --> 00:16:01,120
Так что это группа с именем Tom, и вот ее ID.

186
00:16:01,120 --> 00:16:03,560
И это поведение по умолчанию.

187
00:16:03,560 --> 00:16:14,640
Можно также сменить пароль пользователя с помощью команды password и имени пользователя.

188
00:16:14,640 --> 00:16:18,320
И, конечно, это тоже административная задача.

189
00:16:18,320 --> 00:16:24,160
Теперь мы можем задать новый пароль.

190
00:16:24,160 --> 00:16:25,720
Вот и все.

191
00:16:25,720 --> 00:16:27,200
Пароль обновлен.

192
00:16:27,200 --> 00:16:33,280
Теперь мы можем выйти из виртуальной машины и войти как пользователь Tom.

193
00:16:33,280 --> 00:16:38,320
Или можем сделать это прямо в командной строке.

194
00:16:38,320 --> 00:16:50,200
Используя команду SU с дефисом и именем пользователя, под которым хотим войти, и его пароль.

195
00:16:50,240 --> 00:16:56,400
И прямо здесь, как видите, мы вошли как пользователь Tom.

196
00:16:56,400 --> 00:17:05,240
Это просто имя компьютера, но сейчас мы в домашнем каталоге Tom.

197
00:17:05,240 --> 00:17:14,480
И таким же образом можем переключиться обратно на моего пользователя.

198
00:17:14,560 --> 00:17:21,200
С той же командой вы можете войти в систему как пользователь root.

199
00:17:21,200 --> 00:17:26,120
Без указания имени пользователя здесь по умолчанию будет root.

200
00:17:26,120 --> 00:17:31,720
Так что SU с дефисом авторизует вас как root.

201
00:17:31,720 --> 00:17:38,800
Конечно, вам придется указать пароль пользователя root.

202
00:17:38,800 --> 00:17:44,920
Допустим, мы хотим создать новую группу DevOps, куда будут добавлены все участники нашей команды

203
00:17:44,920 --> 00:17:47,480
или инженеры.

204
00:17:47,480 --> 00:17:52,520
Тогда мы можем выдать права этой группе DevOps вместо того, чтобы давать права

205
00:17:52,520 --> 00:17:55,400
каждому пользователю по отдельности.

206
00:17:55,400 --> 00:17:57,360
И как мы можем добавить группу?

207
00:17:57,360 --> 00:18:04,040
Тоже совсем просто: sudo group add и имя группы.

208
00:18:04,040 --> 00:18:07,000
Мы собираемся добавить новую группу с именем DevOps.

209
00:18:07,000 --> 00:18:12,520
И конечно, если вы хотите убедиться, что группа добавлена, можно вывести список

210
00:18:12,520 --> 00:18:19,440
групп из файла slash etc slash group.

211
00:18:19,440 --> 00:18:20,440
Вот и все.

212
00:18:20,440 --> 00:18:26,640
В конце у нас имя группы и ее ID, маленькое примечание

213
00:18:26,640 --> 00:18:30,400
о командах для создания пользователей и групп.

214
00:18:30,400 --> 00:18:36,280
Если заметили, я использовал команду add user для создания пользователя и group add для создания

215
00:18:36,280 --> 00:18:37,520
группы.

216
00:18:37,520 --> 00:18:43,000
То есть в большинстве дистрибутивов Linux есть такие пары команд при создании

217
00:18:43,000 --> 00:18:45,080
пользователей или групп.

218
00:18:45,080 --> 00:18:51,120
Есть add user и user add, add group и group add.

219
00:18:51,120 --> 00:18:55,440
Если вы видите примеры с этими командами в интернете, это может сбивать с толку.

220
00:18:55,440 --> 00:18:57,720
Так в чем тут разница?

221
00:18:57,720 --> 00:19:04,520
В большинстве дистрибутивов add user и add group — интерактивные, более дружелюбные версии

222
00:19:04,520 --> 00:19:07,480
команд user add и group add.

223
00:19:07,480 --> 00:19:12,600
Что значит интерактивные и удобные: их проще использовать, и вся

224
00:19:12,600 --> 00:19:20,800
нужная информация для создания пользователя или группы, как ID или домашний каталог и т.д., задается автоматически.

225
00:19:20,800 --> 00:19:25,800
Или в интерактивном режиме спрашивается ввод, например пароль.

226
00:19:25,800 --> 00:19:32,320
А в user add и group add нужно передать всю нужную информацию параметрами,

227
00:19:32,320 --> 00:19:36,080
поскольку это более низкоуровневые команды.

228
00:19:36,080 --> 00:19:38,320
Так какую использовать?

229
00:19:38,320 --> 00:19:44,760
Как правило, используйте команды user add и group add в скриптах, когда вы выполняете

230
00:19:44,760 --> 00:19:52,000
эти команды автоматически, а add user и add group — когда запускаете

231
00:19:52,000 --> 00:19:53,720
их вручную.

232
00:19:53,720 --> 00:20:01,280
То же касается пар user del или delete и del user, а также group del и del group

233
00:20:01,280 --> 00:20:02,920
команд.

234
00:20:02,920 --> 00:20:08,800
Теперь допустим, мы хотим сменить основную группу пользователя Tom на DevOps.

235
00:20:08,800 --> 00:20:10,560
Как это сделать?

236
00:20:10,560 --> 00:20:16,920
С помощью команды user mod, которая изменяет пользователя.

237
00:20:16,920 --> 00:20:25,320
Можно выполнить user mod минус или дефис g, затем основную группу, в которой должен быть пользователь,

238
00:20:25,320 --> 00:20:27,840
и имя пользователя.

239
00:20:27,840 --> 00:20:35,240
Если я выполню это, DevOps станет основной группой пользователя Tom.

240
00:20:35,240 --> 00:20:42,440
И теперь, раз группа Tom больше не нужна, можно удалить ее командой del group

241
00:20:42,440 --> 00:20:45,400
или group del.

242
00:20:45,400 --> 00:20:53,400
То есть можно выполнить del group Tom, и это удалит группу Tom.

243
00:20:53,400 --> 00:20:57,280
Теперь мы можем добавить пользователя в несколько групп, верно?

244
00:20:57,280 --> 00:21:03,400
Кроме одной основной группы у пользователя может быть несколько вторичных групп.

245
00:21:03,400 --> 00:21:10,120
В результате пользователь получит все права групп, к которым принадлежит.

246
00:21:10,120 --> 00:21:19,360
Чтобы добавить пользователя в несколько вторичных групп, можно использовать user mod с опцией дефис заглавная G, а затем

247
00:21:19,360 --> 00:21:23,920
список групп, в которые нужно добавить пользователя.

248
00:21:23,920 --> 00:21:29,480
Можно указать admin и какую-то другую группу и имя пользователя.

249
00:21:29,480 --> 00:21:33,960
В нашем случае добавим Tom в группу admin.

250
00:21:33,960 --> 00:21:40,040
Но учтите, опция с заглавной G перезапишет весь список вторичных групп.

251
00:21:40,040 --> 00:21:43,320
Так она всегда устанавливает новый список групп для пользователя.

252
00:21:43,320 --> 00:21:48,720
Если вы хотите добавить пользователя в новую вторичную группу в дополнение к существующим, в которые он

253
00:21:48,720 --> 00:21:55,520
уже входит, мы используем дополнительно опцию -A.

254
00:21:55,520 --> 00:22:02,800
Используя эту команду, мы можем фактически добавить новую группу к существующим.

255
00:22:02,800 --> 00:22:09,360
Как видите, команды Linux принимают разные опции, чтобы изменить поведение по умолчанию,

256
00:22:09,360 --> 00:22:11,920
это пример с командой usermod.

257
00:22:11,920 --> 00:22:17,480
Но и для других команд, например add user, add group и так далее, вы можете использовать разные

258
00:22:17,480 --> 00:22:23,600
опции, чтобы задать свой ID и изменить значения по умолчанию для пользователя или группы при создании

259
00:22:23,600 --> 00:22:26,680
их, добавляя опции к команде.

260
00:22:26,680 --> 00:22:32,080
Вы можете посмотреть документацию или так называемые man-страницы для любой

261
00:22:32,080 --> 00:22:36,000
команды Linux, чтобы увидеть все опции, которые можно с ней использовать.

262
00:22:36,000 --> 00:22:37,000
Отлично.

263
00:22:37,000 --> 00:22:40,160
Итак, мы добавили пользователя в несколько групп.

264
00:22:40,160 --> 00:22:45,600
Как на деле вывести или увидеть все группы, к которым принадлежит пользователь, простым способом?

265
00:22:45,600 --> 00:22:53,640
Есть и для этого команда под названием groups, которая отображает группы, к которым в данный момент

266
00:22:53,640 --> 00:22:56,200
принадлежит вошедший в систему пользователь.

267
00:22:56,200 --> 00:23:02,800
А с groups имя_пользователя, например groups Tom, мы можем вывести группы

268
00:23:02,800 --> 00:23:04,360
любого другого пользователя.

269
00:23:04,360 --> 00:23:11,000
Мы также можем войти как пользователь Tom в его учетную запись и вывести группы там.

270
00:23:11,000 --> 00:23:25,480
И если мы переключимся на пользователя Tom и выполним groups, вот здесь видно, что Tom состоит в DevOps и admin

271
00:23:25,480 --> 00:23:26,640
группах.

272
00:23:26,640 --> 00:23:31,600
А если хотите вернуться к предыдущему пользователю, можем также выполнить exit.

273
00:23:31,600 --> 00:23:39,000
Это выйдет из пользователя, и я вернусь в сессию своего предыдущего пользователя.

274
00:23:39,000 --> 00:23:45,560
Мы можем также добавлять пользователей, указывая группу при создании, вместо того чтобы проходить

275
00:23:45,560 --> 00:23:47,000
все эти шаги.

276
00:23:47,000 --> 00:23:55,400
Поэтому при добавлении пользователя командой user add с именем, например Nicole, мы можем

277
00:23:55,400 --> 00:23:58,680
сразу указать группу вот здесь.

278
00:23:58,680 --> 00:24:00,480
Допустим, это группа DevOps.

279
00:24:00,480 --> 00:24:05,480
Так Nicole будет добавлена в группу DevOps.

280
00:24:05,480 --> 00:24:10,760
Однако все равно создастся группа по умолчанию с тем же именем.

281
00:24:10,760 --> 00:24:24,800
Если теперь посмотрим список пользователей, у нас есть новый пользователь с первичным ID группы

282
00:24:24,800 --> 00:24:26,240
этой группы.

283
00:24:26,600 --> 00:24:30,600
Однако он также добавлен в группу DevOps.

284
00:24:30,600 --> 00:24:36,440
Если теперь вы хотите удалить пользователя из группы, для этого нужно выполнить команду под названием

285
00:24:36,440 --> 00:24:40,880
gpasswd.

286
00:24:40,880 --> 00:24:47,680
Затем есть флаг для удаления пользователя и группы.

287
00:24:47,680 --> 00:24:51,480
Это удалит пользователя из указанной группы.

288
00:24:51,840 --> 00:24:58,160
Я выполняю, и мы видим удаление пользователя Nicole из группы DevOps.

289
00:24:58,160 --> 00:25:00,000
Вот и все.

290
00:25:00,000 --> 00:25:04,720
Вот так работают с пользователями и группами в Linux.

291
00:25:04,720 --> 00:25:08,680
В следующей части мы посмотрим права для пользователей и групп.

